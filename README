Arichテスト用読みだしシステム


(arich-4comps.xmlでの構成)
Readout Module - ArichReader - Dispatcher --- ArichLogger  (ハードディスク)
                                           |_ ArichMonitor (画面にヒストグラム)

(reader-monitor.xmlでの構成)
Readout Module - ArichReader - ArichMonitor (画面にヒストグラム)

チャンネル数 144

ヘッダ 34バイト
イベントデータ 144バイト
34 + 144 = 178バイト
178バイトで読み出すと、後段コンポーネントに送るときにオーバーヘッドが
大きくなるのでArichReaderで1000個読み出して後段へ送るようにした
(ArichReader.h中N_CHUNK)

モニターのパラメータ
====================
設定ファイル(arich-4comps.xmlあるいはreader-monitor.xml)で指定する。

<param pid="useLogy">yes</param>
--------------------------------

ヒストグラムをlogで出すときはyesと指定する。
logではなく線形でだすときにはnoと指定する。(指定していないときのデフォルトはno)

<param pid="monitorUpdateRate">100</param>
------------------------------------------

ヒストグラムの書き換えタイミングを指定する。単位は1000回。
100と指定すると100*1000 = 100,000 個データを読んだらヒストグラムを
アップデートする。
(指定しないときのデフォルトは30)

(例)
トリガーレートが30kHzのとき、100と指定すると3秒に1回、ヒストグラムを
アップデートすることになる。
30と指定すると1秒に1回、ヒストグラムをアップデートすることになる。

<param pid="monitorHistogramResetRate">1000</param>
---------------------------------------------------

ヒストグラムをリセットするタイミングを指定する。単位は1000回。
1000と指定すると1000*1000個データを読んだらヒストグラムを
リセットする。
0を指定するとリセットしない。
(指定しないときのデフォルトは0)

(例)
トリガーレートが30kHzのとき1000と指定すると30秒に一回、ヒストグラムを
リセットすることになる。
300と指定すると10秒に1回、ヒストグラムをリセットすることになる。

データの保存場所、ファイルサイズ
================================

<param pid="dirName">/tmp</param>
---------------------------------

ArichLoggerがデータを保存するディレクトリを指定する。
ここで指定したディレクトリはあらかじめ存在する必要がある。
上の例は/tmpにデータを保存する場合の例。

<param pid="maxFileSizeInMegaByte">1024</param>
-----------------------------------------------

上のように指定すると1GBデータを書いたら次のファイルに保存する。
ファイル名は日時、ランナンバーを元に

YYYYMMDDTHHMMSS_ランナンバー_枝番.dat

となる(具体例: 20150716T104710_000001_000.dat)
枝番は最初で3桁で必要があるなら先頭を0でうめる
(最初は0ではなくて000、次は1ではなくて001)。
999の次は4桁になって1000になる。


